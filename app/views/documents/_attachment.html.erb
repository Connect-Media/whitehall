<%
  extra_description ||= ""
  published_on ||= ""
  help_block_id = "attachment-#{attachment.id}-accessibility-help"
  attachment_link_options = attachment.accessible? ? {} : { "aria-describedby" => help_block_id }
  attachment_link_options['rel'] = 'external' if attachment.external?
%>
<%= content_tag_for(:section, attachment.becomes(Attachment), class: attachment.external? ? "hosted-externally" : "embedded") do %>
  <div class="attachment-details content-two-thirds-left govspeak">
    <h2 class="title"><%= link_to_unless previewable?(attachment), attachment.title, attachment.url(preview: params[:preview]), attachment_link_options %></h2>
    <% unless extra_description.empty? %>
      <p class="extra-description"><%= extra_description %></p>
    <% end %>

    <span class="changed"><%= t('attachment.headings.published') %>: <%= absolute_date(Time.new('2014-12-15T18:03:00+00:00')) %></span>
    <!-- Publishing/Changes information -->
    <% unless published_on.blank? %>
      <span class="changed"><%= t('attachment.headings.published') %>: <%= absolute_date(published_on) %></span>
    <% end %>


    <% if attachment.isbn.present? or attachment.unique_reference.present? or attachment.command_paper_number.present? or attachment.hoc_paper_number.present? %>
      <span class="references">
        <%= t('attachment.headings.reference') %>: <%= attachment_reference(attachment) %>
      </span>
    <% end %>

    <% if attachment.unnumbered_command_paper? || attachment.unnumbered_hoc_paper? %>
      <span class="unnumbered-paper">
        <% if attachment.unnumbered_command_paper? %>
          <%= t('attachment.headings.unnumbered_command_paper') %>
        <% else %>
          <%= t('attachment.headings.unnumbered_hoc_paper') %>
        <% end %>
      </span>
    <% end %>

    <% if previewable?(attachment) %>
      <span class="preview">
        <strong>
          <%= link_to "View online", preview_path_for_attachment(attachment) %>
        </strong>
      </span>
      <span class="download">
        <%= link_to attachment.url(preview: params[:preview]) do %>
          <strong>Download <%= attachment.file_extension.upcase %></strong>
          <%= number_to_human_size(attachment.file_size) %>
        <% end %>
      </span>
    <% end %>
  </div>

  <div class="metadata content-one-third">
    <%= render partial: "documents/attachment_attributes",
      locals: {
        attachment: attachment
      }
    %>
  </div>

  <div class='deal-with-this-in-a-minute-lol'>
    <% if attachment.order_url.present? %>
      <p>
        <%= link_to t('attachment.headings.order_a_copy'), attachment.order_url,
            class: "order_url", title: t('attachment.headings.order_a_copy_full') %>
        <% if attachment.price %>
          (<span class="price"><%= number_to_currency(attachment.price, unit: "&pound;".html_safe) %></span>)
        <% end %>
      </p>
    <% end %>


  </div>
<% end %>
