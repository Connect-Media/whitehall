<h1>
  <%= "#{@filter.page_title}" %>
</h1>

<style>
.table-header {
  background-color: $gray-lighter;
}

thead .table-header-secondary td {
  border-bottom: 1px solid #ccc;
}
</style>

<div class="row-fluid">
  <div class="span7">
    <%= paginate @filter.editions, theme: 'twitter-bootstrap' %>
  </div>
  <div class="span5">
    <div class="publishing-stats">
      <% if @filter.show_stats %>
        <div class="stat">
          <strong><%= number_with_delimiter(@filter.published_count) %></strong> published documents
        </div>
        <div class="stat">
          <strong><%= number_with_delimiter(@filter.force_published_count) %></strong> force published
        </div>
        <div class="stat">
        <strong><%= @filter.force_published_percentage %>%</strong> force published
        </div>
        <% else %>
        <div class="stat">
          <strong><%= number_with_delimiter(@filter.editions.total_count) %></strong> documents
        </div>
      <% end %>
    </div>
  </div>
</div>
<table class="table table-bordered table-striped">
  <thead>
    <tr class="table-header">
      <% unless @filter.hide_type %>
        <th class="type">Type</th>
      <% end %>
      <th class="title">Title</th>
      <th class="updated-by">Updated by</th>
      <th class="updated">Updated</th>
      <% if viewing_all_active_editions? %>
        <th class="state">State</th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% if @filter.editions.blank? %>
      <tr>
        <td colspan="5">No documents have been found.</td>
      </tr>
    <% end %>
    <% @filter.editions.each do |edition| %>
      <%= content_tag_for(:tr, edition, class: ('force_published' if edition.force_published?)) do %>
        <% unless @filter.hide_type %>
          <td class="type"><%= edition_type(edition) %></td>
        <% end %>
        <td class="title">
          <span class="title"><%= link_to edition.title, admin_edition_path(edition), title: "View document #{edition.title}" %></span>
          <% if edition.non_english_edition? %>
            (<%= edition.locale %>)
          <% end %>
          <% if edition.force_published? %>
            <span class="force_published label label-important">not reviewed</span>
          <% end %>
          <% if edition.access_limited? %>
            <span class="access_limited label label-important">limited access</span>
          <% end %>
          <% if edition.allows_supporting_pages? && edition.has_active_supporting_pages? %>
            <div class="supporting_pages additional_information well">
              <h4>Supporting Pages</h4>
              <ul>
                <% edition.active_supporting_pages.includes(:translations).each do |supporting_page| %>
                <li><%= link_to supporting_page.title, admin_supporting_page_path(supporting_page) %></li>
                <% end %>
              </ul>
            </div>
          <% end %>
        </td>
        <td class="author"><%= linked_author(edition.last_author) %></td>
        <td class="updated"><span title="<%= edition.updated_at %>"><%= time_ago_in_words edition.updated_at %> ago</span></td>
        <% if viewing_all_active_editions? %>
          <td class="state"><%= edition.state.humanize %></td>
        <% end %>
      <% end %>
    <% end %>
  </tbody>
</table>
<%= paginate @filter.editions, theme: 'twitter-bootstrap' %>
